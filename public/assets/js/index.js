let history = "Abitare nella storia";
let biodeversiy = "Biodiversità";
let difesa = "Fortificazioni e segni di confine";
let genio = "Genio umano";
let cielo = "Strati di terra e di cielo";
let mulini = "Mulini"

let mappaComplessiva = true;
let temaAttivo = genio;


/* Adds Open Street Map And Street, Satellite, Dark*/
var attrib = 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors'

var OpenStreetMap_Mapnik = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
});

var attrib = 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>'
token = 'pk.eyJ1IjoidGVvanV2ZTkzIiwiYSI6ImNqaDh4d3ZwaTA4YTMzNW82Y2RmdXB1eGMifQ.IXhtJ-tsQl86u2Lhlnzn_w'

var light = L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
    attribution: attrib,
    maxZoom: 18,
    id: 'mapbox/light-v10',
    accessToken: token
});

mbAttr = 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community';
mbUrl = 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}';

var satellite = L.tileLayer(mbUrl, {
    id: 'mapbox.streets',
    attribution: mbAttr,
    maxZoom: 18,
});

var markersLegend = {};

var historySVG = L.divIcon({
    html: `
<svg version="1.1" id="Livello_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
\t viewBox="0 0 595.28 841.89" style="enable-background:new 0 0 595.28 841.89;" xml:space="preserve">
<style type="text/css">
\t.st0{fill:#F9B233;}
</style>
<g>
\t<path class="st0 history" d="M108.63,571.53c2.38,0,4.36-0.03,6.33,0c8.22,0.13,11.15,3.04,11.19,11.24c0.04,9.11,0.01,18.23,0.01,27.34
\t\tc0,7.97,0,15.94,0,24.01c63.52,0,126.41,0,189.73,0c0-8.3,0-16.1,0-24.47c-2.03,4.67-5.23,7.02-10.19,6.98
\t\tc-11.3-0.09-22.6,0.05-33.9-0.06c-6.64-0.06-9.98-3.51-10.05-10.24c-0.09-8.93-0.19-17.87,0.04-26.79
\t\tc0.37-14.33,12.08-25.82,26.38-26.2c13.99-0.37,26.24,10.28,27.38,24.43c0.63,7.79,0.25,15.66,0.37,23.49
\t\tc0.02,1.44,0.27,2.88,0.56,5.7c7.35-21.43,20.5-34.2,42.12-35.14c24.85-1.08,39.73,12.54,47.59,36.99c0-10.25-0.07-18.8,0.02-27.36
\t\tc0.16-15.85,11.66-27.89,26.77-28.12c15-0.23,26.97,11.57,27.48,27.41c0.27,8.38,0.17,16.77,0.03,25.15
\t\tc-0.12,7.41-3.46,10.64-10.82,10.69c-9.66,0.07-19.32-0.13-28.98,0.08c-5.53,0.12-10.74-0.06-14.26-5.7c0,8.13,0,15.55,0,23.18
\t\tc21.12,0,41.91,0,63.09,0c0-2.26,0-4.06,0-5.85c0-14.76-0.01-29.53,0-44.29c0.01-9.81,2.51-12.37,12.13-12.48
\t\tc1.76-0.02,3.52,0,5.83,0c0-8,0-15.26,0-22.52c0-7.41,0-14.82,0-22.37c-126.77,0-252.77,0-378.84,0
\t\tC108.63,541.72,108.63,556.36,108.63,571.53z M198.53,579.26c0.68-14.69,12.81-26.01,27.18-25.92c14.4,0.09,26.13,11.26,26.9,26.22
\t\tc0.47,9.08,0.28,18.2,0.07,27.29c-0.15,6.32-3.73,9.52-10.07,9.75c-0.18,0.01-0.36,0-0.55,0c-5.46,0-10.92,0-16.38,0
\t\tc-5.82,0-11.65,0.11-17.47-0.03c-6.02-0.15-9.61-3.5-9.74-9.47C198.27,597.82,198.1,588.52,198.53,579.26z M135.31,579.59
\t\tc0.8-15.19,12.86-26.47,27.4-26.25c14.9,0.23,26.49,12.09,26.74,27.53c0.14,8.37,0.1,16.74,0.01,25.11
\t\tc-0.08,7.26-3.48,10.53-10.84,10.61c-5.46,0.06-10.92,0.01-16.38,0.01c-5.64,0-11.29,0.08-16.92-0.03
\t\tc-6.42-0.13-9.92-3.3-10.08-9.7C135.01,597.79,134.83,588.66,135.31,579.59z"/>
\t<path class="st0 history" d="M338.73,508.27c47.58,0,95.15-0.09,142.72,0.13c4.7,0.02,6.22-1.52,7.07-5.78c2.54-12.84,5.47-25.61,8.4-39.08
\t\tc-132.99,0-265.37,0-398.17,0c3.29,15.17,6.49,29.87,9.71,44.73c2.81,0,4.99,0,7.16,0C189.99,508.27,264.36,508.27,338.73,508.27z"
\t\t/>
\t<path class="st0 history" d="M180.49,438.45c0-18.41-0.04-36.81,0.03-55.22c0.03-6.65,3.68-10.65,9.19-10.47
\t\tc5.34,0.17,8.64,4.03,8.67,10.47c0.06,14.4,0.02,28.79,0.02,43.19c0,5.97,0,11.94,0,18.19c3.16,0,5.78,0,9.04,0
\t\tc0-2.17,0-4.12,0-6.07c0-17.31,0-34.63,0-51.94c0-1.46-0.06-2.92,0.05-4.37c0.46-5.86,4.11-9.59,9.21-9.48
\t\tc5.1,0.11,8.81,3.97,8.85,9.82c0.11,18.77,0.04,37.54,0.05,56.31c0,1.92,0,3.84,0,5.69c6.38,0,11.96,0,17.55,0
\t\tc0-51.04,0-101.75,0-152.45c-27.12,0-53.81,0-80.44,0c0,51.1,0,101.82,0,152.48c6.02,0,11.61,0,17.78,0
\t\tC180.49,442.38,180.49,440.42,180.49,438.45z M202.74,300.51c17.52-0.09,31.65,13.84,31.74,31.31
\t\tc0.09,17.47-13.88,31.73-31.27,31.92c-17.21,0.19-31.7-14.1-31.87-31.45C171.18,315,185.39,300.6,202.74,300.51z"/>
\t<path class="st0 history" d="M202.92,171.21c-13.79,34.48-27.16,67.93-40.67,101.71c27.44,0,53.96,0,81.32,0
\t\tC230.1,239.21,216.83,206.01,202.92,171.21z"/>
\t<path class="st0 history" d="M108.2,597.23c0-2.48,0-4.96,0-7.47c-24.46,0-48.05,0-71.98,0c0,14.82,0,29.32,0,44.04
\t\tc0.68,0.33,0.99,0.62,1.31,0.62c22.38,0.08,44.77,0.09,67.15,0.23c3.62,0.02,3.53-2.15,3.53-4.66
\t\tC108.18,619.07,108.2,608.15,108.2,597.23z"/>
\t<path class="st0 history" d="M487.75,589.82c0,14.87,0,29.36,0,44.31c24.25,0,47.96,0,71.71,0c0-15.01,0-29.51,0-44.31
\t\tC535.44,589.82,511.74,589.82,487.75,589.82z"/>
\t<path class="st0 history" d="M89.65,517.57c-11.96,0-23.54,0-35.42,0c0,17.84,0,35.4,0,53.18c11.97,0,23.66,0,35.42,0
\t\tC89.65,552.81,89.65,535.26,89.65,517.57z"/>
\t<path class="st0 history" d="M541.47,517.71c-12.13,0-23.84,0-35.43,0c0,17.99,0,35.56,0,53.09c12.01,0,23.59,0,35.43,0
\t\tC541.47,553.03,541.47,535.6,541.47,517.71z"/>
\t<path class="st0 history" d="M73.39,431.07c-0.26-1.23-0.67-2.43-1-3.64c-0.3-0.07-0.59-0.15-0.89-0.22c-5.06,23.67-10.13,47.34-15.25,71.3
\t\tc10.85,0,20.97,0,31.49,0C82.91,475.77,78.16,453.42,73.39,431.07z"/>
\t<path class="st0 history" d="M524.99,430.89c-0.26-1.23-0.7-2.42-1.49-5.09c-4.98,23.07-9.62,44.53-14.24,65.99
\t\tc-0.45,2.11-0.77,4.24-1.2,6.65c10.5,0,20.75,0,31.32,0C534.53,475.63,529.77,453.26,524.99,430.89z"/>
\t<path class="st0 history" d="M334.71,634.01c5.58,0,11.16,0,16.81,0c0-14.29,0-28.28,0-42.51C333.66,599.04,332.32,613.71,334.71,634.01z"
\t\t/>
\t<path class="st0 history" d="M370.36,592.04c0,13.91,0,27.82,0,42c5.86,0,11.43,0,17.27,0C390.98,610.94,384.01,594.33,370.36,592.04z"/>
</g>
</svg>`,
    className: "history",
    iconSize: [34, 50],
});

var muliniSVG = L.divIcon({
    html: `
<svg version="1.1" id="Livello_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
\t viewBox="0 0 595.3 841.9" style="enable-background:new 0 0 595.3 841.9;" xml:space="preserve">
<style type="text/css">
\t.st0{fill:#009EE2;}
</style>
<g>
\t<g>
\t\t<path class="st0 mulini" d="M205.8,365.6c-1,0.1-2.1,0.2-3.1,0.2c-0.1,0.1-0.2,0.1-0.3,0.2c-0.1,0.1-0.5,0.3-0.8,0.6
\t\t\tc1.3-0.3,2.6-0.5,3.9-0.8C205.6,365.7,205.7,365.7,205.8,365.6z"/>
\t\t<path class="st0 mulini" d="M551.2,555.5L551.2,555.5l-26.6,0v0.1h-2.1c-1.6-18.9-6-36.8-14.7-54.3c6.5-3.8,12.8-7.4,19-11.1
\t\t\tc1.5-0.9,3.1-1.7,4.5-2.7c4.5-3.1,5.8-8,3.2-12.3c-2.5-4.2-7.6-5.6-12.4-2.9c-7.6,4.2-15.1,8.6-23.1,13.2
\t\t\tc-11-15.7-24-29.2-40.1-39.9c4.3-7.4,8.4-14.5,12.4-21.6c3.5-6.1,2.7-11.4-2.1-14.1c-4.9-2.8-9.7-1-13.3,5.1
\t\t\tc-4.1,7.1-8.2,14.2-12.6,21.7c-17.2-8.4-35.2-13.1-54.3-14.7v-20.9c0,0,0,0,0,0v-4.3h0c-0.2-4.9-4.3-8.8-9.2-8.8
\t\t\tc-5,0-9,3.9-9.2,8.8h0v24.6c-9.3,1.8-18.7,3-27.7,5.4c-9,2.4-17.7,6.1-26.9,9.3c-4-6.9-8.2-14.2-12.4-21.4
\t\t\tc-3.4-5.8-8.2-7.5-13-4.9c-4.7,2.6-5.7,8-2.5,13.7c4.1,7.3,8.3,14.5,12.7,22c-15.8,10.8-29,23.9-39.9,40
\t\t\tc-6.2-3.6-12.2-7-18.2-10.4c-1.8-1-3.6-2.2-5.5-3.1c-4.7-2.2-9.5-0.9-11.9,3.2c-2.6,4.3-1.5,9.4,3.2,12.2
\t\t\tc7.6,4.6,15.3,9,23.4,13.7c-8.3,17.3-13.3,35.3-14.6,54.4h-0.1v-0.1h-26.6v0c-4.9,0.2-8.8,4.3-8.8,9.2c0,5,3.9,9,8.8,9.2v0H236
\t\t\tc3.4,14.9,6.6,29.2,10,44.2c-3.6,2.7-8.1,6-12.5,9.4c-8,6.1-7.8,12,0.6,17.7h5.2c6.9-5.1,13.7-10.1,20.6-15.2
\t\t\tc9-6.6,16-6.6,24.9-0.2c15.9,11.5,30.9,11.5,46.7,0.1c9-6.5,16-6.5,24.9-0.1c15.7,11.5,30.9,11.5,46.7,0c8.9-6.5,16-6.5,24.9,0
\t\t\tc15.5,11.3,30.9,11.4,46.3,0.2c9.6-6.9,16.2-6.9,25.7,0.1c6.7,5,13.4,9.9,20.2,14.9h5.2c8.5-5.9,8.6-11.6,0.2-18
\t\t\tc-4.2-3.2-8.3-6.3-12-9c3.3-14.8,6.6-29.1,10-44.3h0.9v0.1h26.6v0c4.9-0.2,8.8-4.3,8.8-9.2C560,559.8,556.1,555.7,551.2,555.5z
\t\t\t M300.2,605.5c-13.2-27.1-13.1-54.2-0.2-81.1c13.6,13.7,27.1,27.2,40.5,40.6C327.4,578.2,314,591.7,300.2,605.5z M367.5,615.5
\t\t\tc4-4,8.1-8,12.3-12.2c3.8,4.2,7.7,8.4,11.6,12.6C385.5,622.3,375.5,622.4,367.5,615.5z M379.8,582.6c-10,0-17.9-7.8-17.9-17.8
\t\t\tc0-9.7,7.9-17.6,17.5-17.8c9.8-0.2,18.1,7.9,18.1,17.7C397.7,574.6,389.9,582.5,379.8,582.6z M379.4,525.7
\t\t\tc-13.1-13.2-26.5-26.7-40.2-40.5c27-13.2,54-13.1,80.6-0.3C406.4,498.5,392.9,512.1,379.4,525.7z M459.7,604.9
\t\t\tc-13.5-13.7-26.9-27.3-39.8-40.4c12.5-12.5,26.1-26,39.9-39.8C472.4,551.2,472.4,578.1,459.7,604.9z M496.8,607.9h-17.9
\t\t\tc18.2-55.8,6.2-102.5-44.3-135.2c-36.8-23.8-85.6-20-120.3,6.9c-19.4,15-32.3,34.5-38.4,58.3c-6.1,23.8-4,47,5.6,69.9H263
\t\t\tc-16-36.4-11.8-97.4,35-137.9c44.2-38.2,109.1-40.8,156.3-5.8C503.8,501,514.9,562.8,496.8,607.9z"/>
\t</g>
\t<g>
\t\t<path class="st0 mulini" d="M192.8,284.3c1.6-1.2,3.2-2.8,5-3.7c40-20.1,80-40.1,120-60.1c13.1-6.5,26.1-13,39.2-19.7
\t\t\tc9.4-4.8,18.8-4.9,28.2-0.2c53.4,26.7,106.8,53.5,160.2,80.3c1.6,0.8,2.7,2.3,4.1,3.4c-0.2,0.4-0.4,0.8-0.6,1.3
\t\t\tc-118.3,0-236.6,0-354.9,0C193.6,285.2,193.2,284.7,192.8,284.3z"/>
\t\t<path class="st0 mulini" d="M37,517.3c2.9-8.7,5.7-17.1,8.5-25.5c6.5-19.7,13.1-39.3,19.6-59c0.9-2.8,1.9-4.3,5.3-4.2
\t\t\tc58.7,0.1,117.3,0.1,176,0.1c0.7,0,1.3,0.1,2.3,0.2c-6.1,7.3-12.1,14-17.6,21.2c-14.5,19.1-24.8,40.3-30.9,63.5
\t\t\tc-0.8,2.9-1.7,4.3-5.1,4.2c-52-0.1-104-0.1-156-0.1C38.7,517.6,38.3,517.5,37,517.3z"/>
\t\t<path class="st0 mulini" d="M229.4,304.1c94.7,0,188.9,0,283.6,0c0,42,0,84,0,126.5c-5.6-4.9-11.1-9.4-16.2-14.3
\t\t\tc-1.1-1.1-1.1-3.7-1.1-5.7c-0.1-27.3,0-54.5,0-81.8c0-2,0-4.1,0-6.6c-23.6,0-47,0-70.9,0c0,19.2,0,38.6,0,58.4
\t\t\tc-6.2-1.2-11.8-2.3-17.9-3.5c0-18.2,0-36.5,0-55.1c-23.8,0-47,0-70.9,0c0,19.2,0,38.6,0,58.4c-6.1,1.8-11.9,3.6-18.1,5.4
\t\t\tc0-21.5,0-42.4,0-63.7c-23.7,0-47.1,0-71.1,0c0,29.4,0,58.7,0,88.4c-6.1,0-11.6,0-17.4,0C229.4,375.2,229.4,339.9,229.4,304.1z"/>
\t\t<path class="st0 mulini" d="M211.5,621.9c-12.4,0-23.8,0-35.5,0c0-28.8,0-57.4,0-86.2c6.5,0,12.7,0,19.5,0
\t\t\tC190,565.7,195.8,594.2,211.5,621.9z"/>
\t\t<path class="st0 mulini" d="M300.1,340c0,17.2,0.1,34.1-0.1,50.9c0,1.4-1.5,3.2-2.8,4c-7.8,4.9-15.8,9.7-23.8,14.1
\t\t\tc-2.4,1.3-5.4,1.5-8.5,2.3c0-24.4,0-47.7,0-71.4C276.3,340,287.8,340,300.1,340z"/>
\t\t<path class="st0 mulini" d="M442.5,385.4c0-14.8,0-29.9,0-45.5c11.7,0,23.2,0,35.1,0c0,20.8,0,41.4,0,62.3
\t\t\tC465.9,396.6,454.3,391.1,442.5,385.4z"/>
\t\t<path class="st0 mulini" d="M68.6,621.9c-5.9,0-11.4,0-17.1,0c0-28.7,0-57.2,0-86c5.5,0,11.1,0,17.1,0C68.6,564.4,68.6,593,68.6,621.9z"
\t\t\t/>
\t\t<path class="st0 mulini" d="M353.7,376.7c0-12,0-24.2,0-36.8c11.5,0,23.1,0,35,0c0,11.6,0,23.2,0,34.8C377,375.4,365.5,376.1,353.7,376.7
\t\t\tz"/>
\t</g>
</g>
</svg>`,
    className: "mulini",
    iconSize: [34, 50],
});

var bioSVG = L.divIcon({
    html: `
<svg version="1.1" id="Livello_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
\t viewBox="0 0 595.28 841.89" style="enable-background:new 0 0 595.28 841.89;" xml:space="preserve">
<style type="text/css">
\t.st0{fill:#95C11F;}
</style>
<g>
\t<path class="st0 bio" d="M453.95,314.05c-53.25-37.4-111.76-48.9-175.12-31.19c-3.26,0.91-5.44,0.48-7.96-1.79
\t\tc-10.85-9.82-23.65-15.81-37.97-18.58c-2.38-0.46-4.78-0.79-7.6-1.25c0.1-8.77,0.38-17.07,0.18-25.37
\t\tc-0.08-3.41,1.08-4.93,4.16-6.2c10.99-4.53,16.91-15.49,15.19-27.44c-1.66-11.51-11.08-21.11-22.76-21.49
\t\tc-5.84-0.19-11.77,2.25-17.66,3.49c-2.35,2.35-4.7,4.7-7.05,7.05c-1.22,3.4-2.89,6.71-3.59,10.22
\t\tc-2.37,11.96,3.81,23.64,15.15,28.34c3.23,1.34,4.04,3.01,3.96,6.24c-0.2,8.28-0.04,16.57-0.03,25.24
\t\tc-19.83,1.92-36.84,9.45-50.6,23.53c-13.77,14.09-21.02,31.22-22.33,50.39c-10.12,0-20,0-30.16-0.01
\t\tc-3.51-11.34-11.06-19.23-23.86-19.74c-5.34-0.21-10.78,2.2-16.17,3.42c-2.35,2.35-4.7,4.7-7.05,7.05
\t\tc-0.21,0.63-0.33,1.29-0.63,1.87c-7.29,14.22-3.01,29.28,10.34,36.3c13.24,6.96,27.99,1.71,35.48-12.56
\t\tc0.55-1.04,1.68-2.51,2.57-2.53c9.9-0.22,19.8-0.2,29.73-0.25c2.27,16.25,7.81,30.34,18.37,42.01c3.13,3.46,3.47,6.38,2.18,10.62
\t\tc-9.19,30.34-10.31,61.16-4.15,92.15c9.91,49.87,34.59,91.25,73.47,123.86c44.52,37.34,95.86,55.02,154.04,49.73
\t\tc50.75-4.61,92.91-26.71,124.32-67.14c33.37-42.95,43.85-92.2,34.97-145.29C533.45,395.51,502.91,348.43,453.95,314.05z
\t\t M171.35,293.65c23.49-24.16,68.2-26.47,88.79-4.14c-20.85,8.76-39.21,21.14-55.06,36.93c-15.85,15.79-28.37,34.07-37.18,54.89
\t\tC146,362.41,148.01,317.67,171.35,293.65z M403.34,651.34c-40.37,8.61-79.46,3.92-116.77-13.13
\t\tc-53.18-24.31-90.38-64.25-109.86-119.34c-18.16-51.37-15.29-101.95,11.84-150.02c5.66-10.02,13.19-18.97,20.32-29.07
\t\tc2.08,2.08,3.34,3.34,4.6,4.6c71.09,71.09,142.18,142.16,213.2,213.32c1.88,1.88,3.63,4.5,4.14,7.03
\t\tc6.24,31.23,0.03,59.35-21.67,83.33C407.71,649.63,405.43,650.89,403.34,651.34z M532.73,503.66c-0.18,3.31-1.07,6.6-1.08,9.9
\t\tc-0.03,12.21-6.39,20.14-16.3,26.42c-22.67,14.34-47.02,18.28-73.04,12.72c-1.96-0.42-4.01-1.67-5.44-3.11
\t\tc-71.83-71.72-143.59-143.49-215.35-215.28c-0.91-0.91-1.67-1.97-2.62-3.11c13.44-12.49,28.26-22.47,44.93-29.28
\t\tc61.5-25.1,120.75-18.07,175.3,17.75C504.62,362.68,537.03,424.27,532.73,503.66z"/>
\t<path class="st0 bio" d="M287.16,526.61c-12.79-12.68-33.95-12.59-46.63,0.19c-12.8,12.9-12.73,33.72,0.15,46.53
\t\tc12.86,12.78,33.94,12.76,46.59-0.04C299.91,560.5,299.86,539.21,287.16,526.61z"/>
\t<path class="st0 bio" d="M338.6,554.77c-12.87,12.71-13.04,33.65-0.38,46.62c12.48,12.79,33.81,12.9,46.64,0.25
\t\tc12.89-12.71,13-33.62,0.24-46.53C372.3,542.15,351.53,542,338.6,554.77z"/>
\t<path class="st0 bio" d="M258.75,475.62c12.78-12.82,12.78-33.88,0.01-46.58c-12.72-12.65-34.09-12.62-46.69,0.07
\t\tc-12.72,12.81-12.63,33.85,0.18,46.61C225.13,488.54,245.91,488.5,258.75,475.62z"/>
\t<path class="st0 bio" d="M432.62,460.75c-12.84,12.86-12.83,33.62,0.03,46.5c12.81,12.84,33.71,12.86,46.54,0.06
\t\tc12.73-12.71,12.75-33.97,0.05-46.64C466.48,447.93,445.39,447.97,432.62,460.75z"/>
\t<path class="st0 bio" d="M352.23,380.49c12.76-12.68,12.85-33.86,0.18-46.64c-12.63-12.75-33.85-12.78-46.62-0.06
\t\tc-12.86,12.8-12.9,33.61-0.1,46.51C318.47,393.16,339.39,393.24,352.23,380.49z"/>
\t<path class="st0 bio" d="M404.18,363.24c-12.5,13.67-11.93,34.2,1.3,46.46c13.3,12.32,34.12,11.95,46.2-0.83
\t\tc12.55-13.28,12.29-34.5-0.57-46.67C437.68,349.49,416.32,349.96,404.18,363.24z"/>
</g>
</svg>`,
    className: "antro",
    iconSize: [34, 50],
});

var difesaSVG = L.divIcon({
    html: `
<svg version="1.1" id="Livello_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
\t viewBox="0 0 595.3 841.9" style="enable-background:new 0 0 595.3 841.9;" xml:space="preserve">
<style type="text/css">
\t.st0{fill:#E84E1B;}
</style>
<path class="st0 difesa" d="M562,668.3c0,11,0,21.7,0,32.5c-175.7,0-351.2,0-527,0c0-10.8,0-21.5,0-32.5c0.8,0,1.6-0.1,2.4-0.1
\tc26.4,0,52.8,0,79.2,0c1.9,0,2.6-0.5,2.8-2.4c0.8-7.8,1.7-15.6,2.6-23.3c1-8.8,2.1-17.5,3.1-26.3c0.9-7.7,1.7-15.4,2.6-23.2
\tc0.9-7.7,1.8-15.4,2.7-23.1c0.9-7.7,1.7-15.4,2.6-23.2c0.9-7.7,1.8-15.3,2.7-23c0.9-7.8,1.8-15.6,2.7-23.3
\tc0.9-7.7,1.8-15.4,2.7-23.2c0.8-6.7,1.5-13.4,2.3-20.1c0.9-7.8,1.8-15.6,2.7-23.3c0.9-7.7,1.8-15.3,2.6-23
\tc0.9-7.9,1.8-15.8,2.7-23.7c0.9-7.7,1.7-15.3,2.6-23c0.9-7.8,1.8-15.6,2.7-23.3c0.9-7.7,1.8-15.4,2.6-23.2
\tc0.9-7.7,1.8-15.4,2.7-23.2c0.9-7.5,1.7-15.1,2.6-22.8c-15.8,0-31.5,0-47.4,0c0-44,0-87.8,0-131.8c32.8,0,65.8,0,99,0
\tc0,10.7,0,21.4,0,32.2c11.1,0,21.9,0,32.9,0c0-10.7,0-21.4,0-32.2c32.8,0,65.5,0,98.3,0c0,10.7,0,21.3,0,32.2c11.1,0,22,0,33,0
\tc0-0.8,0.1-1.7,0.1-2.5c0-9.2,0-18.3,0-27.5c0-2.4,0-2.4,2.3-2.4c31.6,0,63.2,0,94.8,0c1.7,0,2.4,0.3,2.1,2.2
\tc-0.2,1.7-0.1,3.4-0.1,5.2c0,40.6,0,81.3,0,121.9c0,0.8,0,1.5,0,2.5c-15.8,0-31.6,0-47.5,0c0.3,3.2,0.6,6.1,1,9.1
\tc0.9,7.8,1.8,15.7,2.7,23.5c0.9,7.8,1.8,15.6,2.7,23.3c0.9,7.7,1.7,15.3,2.6,23c0.9,7.8,1.8,15.7,2.7,23.5
\tc0.9,7.6,1.7,15.2,2.6,22.8c0.9,7.9,1.8,15.8,2.7,23.7c0.9,7.7,1.7,15.3,2.6,23c0.9,7.8,1.8,15.6,2.7,23.3
\tc0.9,7.7,1.8,15.4,2.7,23.2c0.9,7.8,1.8,15.6,2.7,23.3c0.9,7.7,1.8,15.3,2.6,23c0.9,7.8,1.8,15.7,2.7,23.5
\tc0.9,7.7,1.8,15.4,2.6,23.2c0.9,7.7,1.8,15.4,2.7,23.2c0.8,6.7,1.5,13.3,2.3,20c0.9,7.9,1.8,15.8,2.8,23.7
\tc0.6,5.5,1.3,11.1,1.8,16.6c0.1,1.6,0.7,2,2.3,2c26.6,0,53.1,0,79.7,0C560.3,668.3,561,668.3,562,668.3z M265.8,667.9
\tc0.9,0,1.6,0,2.3,0c19.5,0,39.1,0,58.6,0c4.6,0,4.6,0,4.6-4.6c0-20.4,0-40.8,0-61.1c0-1.7,0-3.3-0.3-5c-3.2-18.9-19.5-29.8-36.5-28
\tc-16,1.7-29,15.7-29.1,31.9c-0.1,20.7,0,41.5,0,62.2C265.4,664.8,265.7,666.3,265.8,667.9z M331.2,403.6c0.1-0.6,0.1-1.1,0.1-1.7
\tc0-10.5,0.1-20.9,0-31.4c-0.1-9.3-3.6-17.3-10.4-23.8c-7.9-7.6-17.4-10.2-28.1-8.4c-10.5,1.8-18.8,7.1-23.8,16.8
\tc-3.2,6.1-3.6,12.8-3.6,19.4c-0.1,9,0.2,17.9,0.3,26.9c0,0.7,0.1,1.4,0.2,2.1C287.8,403.6,309.5,403.6,331.2,403.6z"/>
</svg>`,
    className: "difesa",
    iconSize: [34, 50],
});

var genioSVG = L.divIcon({
    html: `
<svg version="1.1" id="Livello_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
\t viewBox="0 0 595.28 841.89" style="enable-background:new 0 0 595.28 841.89;" xml:space="preserve">
<style type="text/css">
\t.st0{fill:#312783;}
</style>
<g>
\t<path class="st0 genio" d="M303.13,115.83c10.02,2.34,19.65,5.39,27.77,12.23c13.27,11.18,19.39,25.54,19.62,42.61
\t\tc0.13,9.87,0.17,19.76-0.05,29.63c-0.08,3.84,0.94,6.49,4,9.11c28.96,24.8,38.74,62.15,26.18,98.22c-0.75,2.14-0.84,5.17,0.1,7.15
\t\tc23.64,49.47,47.45,98.86,71.25,148.25c0.32,0.66,0.72,1.27,2.02,3.52c6.85-11.84,13.19-22.65,19.37-33.55
\t\tc1.65-2.91,2.71-6.14,4.25-9.11c4.8-9.25,14.53-12.87,23.45-8.83c9.06,4.1,12.78,14.22,8.57,23.95
\t\tc-8.81,20.42-20.01,39.44-34.59,56.26c-3.81,4.39-4.13,7.58-1.55,12.83c16.37,33.27,32.29,66.76,48.38,100.16
\t\tc10.12,21.01,8.3,40.78-5.73,59.53c-1.15,1.54-1.31,4.79-0.52,6.63c3.1,7.24,6.88,14.2,10.21,21.34c4.86,10.4,1.59,20.78-7.77,25.2
\t\tc-9.16,4.32-19.03,0.48-24.12-9.55c-3.39-6.68-6.68-13.42-9.78-20.24c-1.38-3.04-3-4.34-6.65-4.27
\t\tc-22.6,0.42-39.86-9.15-50.02-29.43c-14.58-29.09-28.42-58.55-42.59-87.84c-0.93-1.93-1.95-3.82-2.46-4.82
\t\tc-22.49,5.17-44.47,10.22-67.49,15.5c0,4.2,0.07,9.86-0.02,15.52c-0.18,11.07-7.58,18.95-17.72,18.97
\t\tc-10.15,0.02-17.61-7.85-17.8-18.9c-0.09-5.52-0.02-11.05-0.02-15.62c-22.64-5.18-44.79-10.25-67.63-15.48
\t\tc-3.16,6.54-6.86,14.13-10.53,21.75c-10.52,21.86-21.23,43.63-31.48,65.61c-10.76,23.07-28.12,35.35-54,34.97
\t\tc-1.71-0.03-4.15,1.86-5.04,3.52c-3.67,6.75-6.78,13.8-10.26,20.66c-5.22,10.29-15.34,14.11-24.6,9.42
\t\tc-9.04-4.58-12.11-14.69-7.38-24.87c3.41-7.33,7.23-14.48,10.44-21.89c0.73-1.68,0.45-4.68-0.63-6.12
\t\tc-14.21-18.92-15.9-38.79-5.58-60.03c16.37-33.71,32.46-67.55,48.86-101.25c1.89-3.88,1.88-6.46-1.08-9.85
\t\tc-14.64-16.78-25.96-35.7-35.07-55.98c-4.9-10.89-1.82-21.23,7.78-25.65c9.65-4.43,18.97-0.01,24.62,10.76
\t\tc6.31,12.02,13.28,23.71,20.02,35.5c0.75,1.32,1.91,2.4,3.21,4.01c1.02-1.97,1.84-3.46,2.58-4.99
\t\tc23.01-47.8,45.98-95.63,69.09-143.38c1.86-3.84,1.99-7.05,0.54-11.1c-11.97-33.56-1.77-72.13,25.32-95.33
\t\tc4.01-3.43,5.45-6.91,5.37-12.07c-0.18-11.83-0.59-23.78,0.69-35.5c2.69-24.64,20.01-42.11,44.44-46.34
\t\tc0.75-0.13,1.44-0.57,2.15-0.86C295.23,115.83,299.18,115.83,303.13,115.83z M324.88,362.66c0.72,1.57,1.52,3.36,2.37,5.13
\t\tc22.68,47.09,45.37,94.18,68.04,141.27c20.62,42.83,41.18,85.69,61.88,128.48c1.69,3.49,3.74,7.1,6.52,9.7
\t\tc6.23,5.83,15.58,5.73,22.29,0.46c7.17-5.63,8.58-14.18,3.84-24.02c-43.97-91.35-87.95-182.69-131.93-274.03
\t\tc-0.81-1.68-1.71-3.31-2.18-4.22C345.17,351.31,335.24,356.87,324.88,362.66z M238.67,345.39c-0.38,0.67-1.02,1.65-1.52,2.69
\t\tc-44.3,92.05-88.58,184.11-132.85,276.17c-0.68,1.41-1.25,2.9-1.72,4.4c-2.27,7.3,0.28,14.98,6.39,19.43
\t\tc6.39,4.66,14.83,4.94,20.86-0.21c3.02-2.58,5.43-6.25,7.18-9.88c43.54-90.23,86.95-180.52,130.37-270.8
\t\tc0.83-1.72,1.51-3.51,1.97-4.61C259.03,356.8,249.11,351.23,238.67,345.39z M297.17,387.28c-23.42,48.68-46.19,96.02-69.12,143.69
\t\tc16.87,6.44,33.53,10.39,51.38,11.69c0-5.58-0.06-10.49,0.01-15.39c0.18-11.11,7.5-18.98,17.64-19.05
\t\tc10.16-0.07,17.67,7.79,17.88,18.81c0.09,5.08,0.02,10.17,0.02,17.1c17.72-4.1,34.4-7.97,51.89-12.01
\t\tC343.32,483.19,320.59,435.96,297.17,387.28z M350.48,277.9c0.84-28.7-22.74-53.13-52.26-54.14c-28.65-0.98-53.13,22.52-54.28,52.1
\t\tc-1.12,28.77,22.92,53.7,52.54,54.46C325.16,331.07,349.61,307.33,350.48,277.9z M314.79,188.8c0-7.2,0.53-14.7-0.14-22.09
\t\tc-0.79-8.82-8.78-15.3-17.5-15.28c-8.72,0.03-16.65,6.56-17.41,15.38c-0.64,7.39-0.13,14.88-0.13,21.98
\t\tC291.34,188.8,302.68,188.8,314.79,188.8z"/>
\t<path class="st0 genio" d="M314.94,276.88c0.09,9.67-7.9,17.8-17.58,17.89c-9.67,0.09-17.8-7.9-17.89-17.58
\t\tc-0.09-9.67,7.9-17.8,17.58-17.89C306.71,259.21,314.85,267.21,314.94,276.88z"/>
</g>
</svg>`,
    className: "genio",
    iconSize: [34, 50],
});

var cieloSVG = L.divIcon({
    html: `
<svg version="1.1" id="Livello_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
\t viewBox="0 0 595.28 841.89" style="enable-background:new 0 0 595.28 841.89;" xml:space="preserve">
<style type="text/css">
\t.st0{fill:#006633;}
</style>
<g>
\t<path class="st0 cielo" d="M155.97,180.84c2.75,1.48,3.65,3.78,3.78,6.88c0.58,13.08,11.5,23.91,24.57,24.63
\t\tc0.44,0.02,0.87,0.02,1.31,0.05c3.26,0.21,5.45,2.28,5.48,5.2c0.04,3.01-2.2,5.2-5.62,5.32c-5.29,0.19-10.18,1.63-14.5,4.7
\t\tc-7.08,5.03-10.85,11.95-11.33,20.63c-0.22,3.92-2.13,6.22-5.29,6.21c-3.16,0-5.1-2.29-5.27-6.22
\t\tc-0.62-13.85-11.45-24.67-25.32-25.29c-3.88-0.17-6.18-2.18-6.13-5.36c0.04-3.08,2.29-5.03,6.01-5.21
\t\tc14.08-0.66,24.87-11.39,25.4-25.45c0.11-2.9,1.42-4.73,3.75-6.09C153.87,180.84,154.92,180.84,155.97,180.84z"/>
\t<path class="st0 cielo" d="M475.85,357.55c-2.75-1.47-3.65-3.77-3.79-6.87c-0.58-12.99-11.31-23.77-24.25-24.62
\t\tc-0.61-0.04-1.22-0.03-1.83-0.07c-3.18-0.24-5.35-2.46-5.28-5.38c0.07-2.81,2.2-5,5.27-5.1c5.28-0.17,10.19-1.5,14.54-4.52
\t\tc7.29-5.06,11.06-12.1,11.72-20.97c0.12-1.68,0.84-3.8,2.05-4.77c1.18-0.94,3.43-1.14,5.03-0.81c2.24,0.47,3.33,2.47,3.35,4.78
\t\tc0.11,14.51,11.82,26.17,26.23,26.26c2.62,0.02,4.03,1.73,5.29,3.68c0,1.05,0,2.1,0,3.16c-1.48,2.75-3.77,3.66-6.86,3.79
\t\tc-13.04,0.57-23.96,11.52-24.53,24.57c-0.13,3.1-1.04,5.4-3.78,6.88C477.95,357.55,476.9,357.55,475.85,357.55z"/>
\t<path class="st0 cielo" d="M255.41,151.37c2.84,1.55,3.95,3.91,3.72,7.15c-0.2,2.77-0.04,5.56-0.04,8.63c2.91,0,5.59,0,8.27,0
\t\tc4.96,0,7.5,1.81,7.45,5.32c-0.05,3.49-2.53,5.2-7.58,5.2c-2.61,0-5.22,0-8.15,0c0,3.3,0.02,6.42,0,9.55
\t\tc-0.03,3.81-2.08,6.22-5.25,6.21c-3.18,0-5.21-2.4-5.24-6.22c-0.02-3.06,0-6.11,0-9.54c-3.25,0-6.36,0.02-9.47,0
\t\tc-3.84-0.02-6.22-2.02-6.26-5.2c-0.04-3.19,2.36-5.28,6.15-5.31c3.06-0.02,6.11,0,9.58,0c0-2.93,0.16-5.79-0.04-8.63
\t\tc-0.23-3.24,0.87-5.61,3.72-7.15C253.31,151.37,254.36,151.37,255.41,151.37z"/>
\t<path class="st0 cielo" d="M367.74,370.19c-2.84-1.55-3.96-3.91-3.72-7.15c0.2-2.77,0.04-5.57,0.04-8.63c-3.08,0-5.94,0-8.8,0
\t\tc-4.48-0.01-6.97-1.92-6.93-5.32c0.04-3.39,2.49-5.19,7.05-5.2c2.78,0,5.57,0,8.68,0c0-3.3-0.02-6.42,0-9.54
\t\tc0.03-3.82,2.06-6.22,5.24-6.22c3.18,0,5.22,2.4,5.25,6.21c0.02,3.06,0,6.12,0,9.55c2.1,0,4.07,0,6.05,0
\t\tc7.16,0,9.63,1.33,9.68,5.19c0.05,3.92-2.54,5.33-9.81,5.33c-1.83,0-3.67,0-5.92,0c0,2.93-0.16,5.79,0.04,8.63
\t\tc0.23,3.24-0.88,5.6-3.72,7.15C369.84,370.19,368.79,370.19,367.74,370.19z"/>
\t<path class="st0 cielo" d="M306.23,201.87c3.17-0.05,5.24,2.31,5.35,6.13c0.28,9.8,3.45,18.55,9.78,26.03
\t\tc8.25,9.75,18.84,14.78,31.62,15.17c3.56,0.11,5.9,2.28,5.83,5.38c-0.07,3-2.34,5-5.79,5.16c-1.74,0.08-3.49,0.21-5.22,0.44
\t\tc-20.14,2.64-35.67,20-36.23,40.43c-0.03,1.2-0.18,2.48-0.65,3.56c-0.93,2.15-3.47,3.27-5.68,2.77c-2.45-0.56-3.78-2.59-4.21-5.36
\t\tc-0.76-4.99-1.17-10.17-2.88-14.85c-5.82-15.99-21.06-26.54-38.08-27c-3.87-0.1-6.21-2.07-6.23-5.25c-0.02-3.18,2.33-5.19,6.18-5.3
\t\tc22.6-0.63,40.33-18.47,41.04-41.27C301.17,204.22,303.14,201.92,306.23,201.87z"/>
\t<path class="st0 cielo" d="M416.52,207.13c0,3.55,0.03,6.7-0.01,9.85c-0.04,3.57-2.2,5.94-5.29,5.91c-3.09-0.03-5.16-2.39-5.19-6
\t\tc-0.03-3.14-0.01-6.28-0.01-9.76c-3.28,0-6.4,0.02-9.51,0c-3.82-0.03-6.21-2.05-6.22-5.24c-0.01-3.19,2.38-5.24,6.19-5.27
\t\tc3.05-0.02,6.11,0,9.55,0c0-3.23-0.01-6.34,0-9.46c0.02-3.86,1.99-6.25,5.16-6.3c3.26-0.06,5.31,2.4,5.34,6.39
\t\tc0.02,2.89,0.03,5.78,0.06,8.67c0,0.15,0.13,0.3,0.31,0.7c3.02,0,6.14-0.02,9.27,0.01c3.75,0.03,6.17,2.18,6.1,5.36
\t\tc-0.07,3.09-2.43,5.11-6.05,5.15C423.07,207.15,419.94,207.13,416.52,207.13z"/>
\t<path class="st0 cielo" d="M192.7,341.78c-3.49,0-6.63,0.03-9.76-0.01c-3.6-0.04-5.95-2.12-5.97-5.23c-0.02-3.1,2.34-5.23,5.91-5.28
\t\tc3.06-0.04,6.12-0.04,9.18-0.06c0.08,0,0.16-0.04,0.64-0.17c0-2.99-0.01-6.11,0-9.22c0.02-3.86,1.98-6.25,5.15-6.31
\t\tc3.26-0.06,5.32,2.4,5.34,6.38c0.02,3.04,0,6.09,0,9.38c3.37,0,6.5-0.02,9.62,0.01c3.75,0.03,6.17,2.17,6.1,5.35
\t\tc-0.06,3.09-2.42,5.12-6.04,5.16c-3.13,0.03-6.26,0.01-9.69,0.01c0,3.33,0.02,6.46,0,9.58c-0.03,3.79-2.11,6.2-5.28,6.18
\t\tc-3.18-0.03-5.18-2.42-5.21-6.26C192.68,348.23,192.7,345.18,192.7,341.78z"/>
\t<path class="st0 cielo" d="M332.45,180.79c-2.9-0.04-5.27-2.55-5.16-5.44c0.11-2.8,2.5-5.08,5.3-5.04c2.9,0.04,5.28,2.55,5.16,5.44
\t\tC337.64,178.55,335.24,180.83,332.45,180.79z"/>
\t<path class="st0 cielo" d="M544.37,315.49c-2.9-0.02-5.29-2.51-5.19-5.41c0.09-2.8,2.47-5.09,5.26-5.07c2.9,0.02,5.29,2.51,5.2,5.4
\t\tC549.54,313.22,547.16,315.51,544.37,315.49z"/>
\t<path class="st0 cielo" d="M105.56,304.01c-0.04,2.9-2.55,5.29-5.43,5.17c-2.79-0.11-5.06-2.52-5.02-5.32c0.04-2.9,2.54-5.28,5.43-5.16
\t\tC103.33,298.81,105.6,301.21,105.56,304.01z"/>
\t<path class="st0 cielo" d="M495.26,223.02c-0.07,2.9-2.61,5.26-5.49,5.11c-2.79-0.14-5.04-2.57-4.97-5.37c0.07-2.9,2.59-5.26,5.48-5.11
\t\tC493.07,217.8,495.33,220.22,495.26,223.02z"/>
\t<path class="st0 cielo" d="M288.86,349.06c0.05,2.9-2.37,5.36-5.26,5.34c-2.8-0.02-5.14-2.34-5.2-5.15c-0.06-2.9,2.36-5.35,5.26-5.34
\t\tC286.46,343.94,288.81,346.26,288.86,349.06z"/>
\t<path class="st0 cielo" d="M427.13,264.99c2.8,0.06,5.11,2.42,5.12,5.22c0.01,2.9-2.45,5.33-5.34,5.27c-2.9-0.06-5.25-2.58-5.12-5.48
\t\tC421.93,267.2,424.34,264.94,427.13,264.99z"/>
\t<g>
\t\t<path class="st0 cielo" d="M514.53,561.26c9.89-1.31,16.09-4.58,19.93-13.91c4.47-10.84,10.11-21.19,15.81-32.92
\t\t\tc-134.27,9.96-246.82,62.31-339.7,156.98c0,0.81,0,1.63,0,2.44c14.69,3.38,29.35,6.93,44.12,9.93c2.13,0.43,5.19-1.34,7.15-2.92
\t\t\tc14.67-11.84,28.6-24.68,43.84-35.73C368.23,599.77,437.85,571.44,514.53,561.26z"/>
\t\t<path class="st0 cielo" d="M317.3,513.01c-1.87,1.1-3.81,2.07-5.73,3.08c-43.99,23.22-84.34,51.63-120.69,85.57
\t\t\tc-14.03,13.1-27.22,27.11-41.75,41.67c13.86,7.6,26.29,14.42,39.06,21.43c2.56-2.78,4.57-5.04,6.66-7.23
\t\t\tc77.62-81.08,171.35-133.14,281.52-154.76c24.39-4.79,49.43-6.19,74.15-9.33c2.42-0.31,6.36-1.44,6.74-2.92
\t\t\tc3.31-12.93,5.96-26.03,9-39.94c-3.53,0-5.65-0.05-7.76,0.01c-32.18,0.84-64.01,4.76-95.53,11.18
\t\t\tc-35.78,7.29-70.46,18.19-104.26,31.96c-7.62,3.1-13.63,0.98-15.93-5c-2.36-6.12,0.56-11.56,8.06-14.65
\t\t\tc64.15-26.44,130.79-41.65,200.19-44.45c5.34-0.22,10.68-0.62,15.39-0.9v-42.18c-90.25,1.76-175.12,21.45-255.78,58.92
\t\t\tc-80.7,37.48-150.37,89.88-209.67,157.1c10.56,9.62,20.64,18.82,31.23,28.46c2.07-2.13,3.46-3.47,4.74-4.9
\t\t\tc42.01-46.97,90.3-86.22,144.79-117.84c8.43-4.9,17.04-9.52,25.68-14.04c6.8-3.56,12.77-2.03,15.76,3.63
\t\t\tC326.11,503.42,323.92,509.12,317.3,513.01z"/>
\t\t<path class="st0 cielo" d="M214.8,417.45c-24.24-7.87-48.86-14.4-73.95-19.25c-34.78-6.73-69.85-10.85-105.3-11.65
\t\t\tc-4.11-0.09-5.83,0.87-5.94,5.24c-0.26,9.72-1,19.42-1.58,29.65c10.19,0.59,19.64,1.14,29.1,1.69
\t\t\tc43.48,2.56,86.11,10.06,127.83,22.48c3.8,1.13,8.24,4.64,9.72,8.16c2.97,7.09-3.4,13.91-11.34,12.82
\t\t\tc-5.12-0.71-10.15-2.22-15.16-3.6c-44.14-12.18-89.2-18.03-134.86-19.82c-1.03-0.04-2.07,0.11-4,0.22
\t\t\tc1.91,11.92,3.75,23.38,5.6,34.94c14.62,1.2,28.69,1.89,42.64,3.63c17.2,2.16,34.31,5.04,51.4,7.94
\t\t\tc6.87,1.16,10.64,6.62,9.54,12.5c-1.13,6.05-6.01,9.3-13.3,8.27c-19.31-2.74-38.57-5.86-57.9-8.47
\t\t\tc-8.35-1.12-16.82-1.35-26.66-2.09c5.02,12.07,9.54,23.25,14.4,34.27c0.57,1.29,2.97,2.21,4.66,2.47
\t\t\tc5.35,0.84,10.78,1.16,16.15,1.91c8.32,1.16,12.25,5.3,11.59,11.92c-0.62,6.18-5.42,9.51-13.31,9.23
\t\t\tc-1.27-0.04-2.55-0.01-5.46-0.01c6.38,9.09,12.1,17.26,18.25,26.03c54.56-60.52,116.22-108.86,185.18-145.17
\t\t\tC253.07,431.51,233.76,423.82,214.8,417.45z"/>
\t\t<path class="st0 cielo" d="M451.28,638.83c14.41-11.99,28.85-23.94,42.88-36.35c0.91-0.81,1.79-1.66,2.65-2.53
\t\t\tc1.37-1.46,2.64-2.84,3.81-4.14c3.21-3.72,6.26-7.72,9.63-11.59c-46.79-4.04-177.46,56.4-222.44,102.78
\t\t\tC358.93,689.31,413.82,664.6,451.28,638.83z"/>
\t</g>
</g>
</svg>`,
    className: "cielo",
    iconSize: [34, 50],
});

/* Filter data for Abitare nella storia */
function func_storia(feature) {
    if (feature.properties.Tema === history) return true
}


var poistoria = L.geoJSON(poi, {
    filter: func_storia,
    pointToLayer: function (feature, latlng) {
        var historyMarker = new L.marker(latlng, {
            icon: historySVG
        });
        if(!Object.keys(markersLegend).includes(history) && (temaAttivo===history || mappaComplessiva)) markersLegend[history] = historyMarker;
        return historyMarker
    }
});

poistoria.on("click", function(pointObject){
    let feature = pointObject.layer.feature;
    populatePopupLeftBar(feature);
});


/* Filter data for Difesa del territorio */
function func_difesa(feature) {
    if (feature.properties.Tema === difesa) return true
}

var poidifesa = L.geoJSON(poi, {
    filter: func_difesa,
    pointToLayer: function (feature, latlng) {
        var difesaMarker = new L.marker(latlng, {
            icon: difesaSVG,
        });
        if(!Object.keys(markersLegend).includes(difesa) && (temaAttivo===difesa || mappaComplessiva)) markersLegend[difesa] = difesaMarker;
        return difesaMarker
    }
});

poidifesa.on("click", function(pointObject){
    let feature = pointObject.layer.feature;
    populatePopupLeftBar(feature);
});


/* Filter data for Strati di terra e di cielo */
function func_religiosa(feature) {
    if (feature.properties.Tema === cielo) return true
}

var poireligiosa = L.geoJSON(poi, {
    filter: func_religiosa,
    pointToLayer: function (feature, latlng) {
        var relMarker = new L.marker(latlng, {
            icon: cieloSVG
        });
        if(!Object.keys(markersLegend).includes(cielo) && (temaAttivo===cielo || mappaComplessiva)) markersLegend[cielo] = relMarker;
        return relMarker
    }
});

poireligiosa.on("click", function(pointObject){
    let feature = pointObject.layer.feature;
    populatePopupLeftBar(feature);
});

/* Filter data for Genio umano */
function func_antro(feature) {

    if (feature.properties.Tema === genio) return true
}

var poiantro = L.geoJSON(poi, {
    filter: func_antro,
    pointToLayer: function (feature, latlng) {
        var antroMarker = new L.marker(latlng, {
            icon: genioSVG
        });
        if(!Object.keys(markersLegend).includes(genio) && (temaAttivo===genio || mappaComplessiva)) markersLegend[genio] = antroMarker;
        return antroMarker;
    }
});


poiantro.on("click", function(pointObject){
    let feature = pointObject.layer.feature;
    populatePopupLeftBar(feature);
});


/* Filter data for Biodiversità */
function func_bio(feature) {
    if (feature.properties.Tema === biodeversiy) return true
}

var poiBio = L.geoJSON(poi, {
    filter: func_bio,
    pointToLayer: function (feature, latlng) {
        var bioMarker = new L.marker(latlng, {
            icon: bioSVG
        });
        if(!Object.keys(markersLegend).includes(biodeversiy) && (temaAttivo===biodeversiy || mappaComplessiva)) markersLegend[biodeversiy] = bioMarker;
        return bioMarker
    }
});

poiBio.on("click", function(pointObject){
    let feature = pointObject.layer.feature;
    populatePopupLeftBar(feature);
});



/* Filter data for Mulini */
function func_mulini(feature) {
    if (feature.properties.Tema === mulini) return true
}

var poiMulini = L.geoJSON(poi, {
    filter: func_mulini,
    pointToLayer: function (feature, latlng) {
        mulini["iconUrl"] = "assets/img/icona%20IP%20abitarestoria.svg"
        var muliniMarker = new L.marker(latlng, {
            icon: muliniSVG
        });
        if(!Object.keys(markersLegend).includes(mulini) && (temaAttivo===mulini || mappaComplessiva)) markersLegend[mulini] = muliniMarker
        return muliniMarker
    }
});

poiMulini.on("click", function(pointObject){
    let feature = pointObject.layer.feature;
    populatePopupLeftBar(feature);
});


/*Defines The Basemap and OverlayMaps List*/
var baseMaps = {
    "Light": light,
    "OSM": OpenStreetMap_Mapnik,
    "Satellite": satellite
};

let layersToUpload = [];

if(mappaComplessiva){
    layersToUpload.push(poistoria, poidifesa, poiantro, poireligiosa, poiBio, poiMulini);
} else{
    switch (temaAttivo){
        case history: layersToUpload.push(poistoria);var overlayMaps = {
            '<u class="gold">Abitare nella storia</u>': poistoria,
        };  break;
        case biodeversiy: layersToUpload.push(poiBio);
            var overlayMaps = {
                '<u class="green"> Biodiversità </u>': poiBio
            };break;
        case difesa: layersToUpload.push(poidifesa);
            var overlayMaps = {
                '<u class="blu"> Difesa del territorio </u>': poidifesa,
            };break;
        case genio: layersToUpload.push(poiantro);
            var overlayMaps = {
                '<u class="orange"> Genio Umano </u>': poiantro
            };break;
        case cielo: layersToUpload.push(poireligiosa);
            var overlayMaps = {
                '<u class="purple"> Strati di terra e di cielo </u>': poireligiosa
            };break;
        case mulini: layersToUpload.push(poiMulini);
            var overlayMaps = {
                '<u class="purple"> Mulini </u>': poiMulini
            };break;
    }
}


/* Defines the Current Map situation When User First Opened The Page*/
var map = L.map("mapid", {
    center: [45.807325, 8.883786],
    zoom: 11.45,
    minZoom: 8,
    layers: [light]
});

/* Adds The Control Button For Layers */
L.control.layers(baseMaps, overlayMaps).addTo(map);

/* Show tooltip only at a certain zoom level*/
/*    var tooltipThreshold = 15;
    map.on('zoomend', function() {
    if (map.getZoom() < tooltipThreshold) {
    $(".leaflet-tooltip").css("display","none")
} else {
    $(".leaflet-tooltip").css("display","block")
}
})*/

/* Adds the coordinates of the mouse position */
L.control.mousePosition().addTo(map);

const legend = L.control.featureLegend(markersLegend, {
    position: "bottomleft",
    title: "",
    symbolContainerSize: 28,
    symbolScaling: "clamped",
    maxSymbolSize: 24,
    minSymbolSize: 2,
    collapsed: false,
    drawShadows: true,
}).addTo(map);

var items = document.querySelectorAll("i img");
var arraySVG = [
    "assets/img/icona IP abitarestoria.svg",
    "assets/img/icona IP fortificazioni.svg",
    "assets/img/icona IP stratiterracielo.svg",
    "assets/img/icona IP genioumano.svg",
    "assets/img/icona IP biodiversità.svg",
    "assets/img/icona IP mulini.svg",
]

if(!mappaComplessiva){

    switch (temaAttivo){
        case history:
            arraySVG = arraySVG.splice(0,1);
            break;
        case biodeversiy:
            arraySVG = arraySVG.splice(1,2);
            break;
        case difesa:
            arraySVG = arraySVG.splice(2, 3);
            break;
        case genio:
            arraySVG = arraySVG.splice(3,4);
            break;
        case cielo:
            arraySVG = arraySVG.splice(4,5);
            break;
        case mulini:
            arraySVG = arraySVG.splice(5,6);
            break;
    }
}


for (var i = items.length; i--;) {
    var img = items[i];
    img.src= arraySVG[i];
}


// Clustering
var markers = L.markerClusterGroup({
    animateAddingMarkers : true,
    showCoverageOnHover: false
});

for(var i = 0; i<layersToUpload.length; i++){
    let layer = layersToUpload[i];
    markers.addLayer(layer);
}
map.addLayer(markers);


function populatePopupLeftBar(feature){
    document.getElementById("placeImg").innerHTML = "";
    document.getElementById("titleInfo").innerText = feature.properties['Nome POI'];
    document.getElementById("contentInfo").innerText = feature.properties['Abstract'];
    if(feature.properties['Abstract_e'] !== null) document.getElementById("textEnglish").innerText = feature.properties['Abstract_en'];

    var foto = feature.properties['Foto'];
    if(foto !== null){
        var img = document.createElement("img");
        img.src = "assets/img/" + feature.properties['Foto'];
        img.setAttribute("height", "100%");
        img.setAttribute("width", "100%");
        document.getElementById("placeImg").appendChild(img);
    } else{
        document.getElementById("placeImg").style.display = "none!important";
    }

    var offCanvas = document.getElementById("offcanvasExample");
    var offCanvasPopup = new bootstrap.Offcanvas(offCanvas);
    offCanvasPopup.show();
}

